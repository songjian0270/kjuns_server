<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kjuns.mapper.SectionMapper">

	<select id="getTotalCount" resultType="int">
		SELECT count(*) FROM kjuns_section where data_flag = 1
		<if test="contentId != null and contentId != ''">
			and content_id = #{contentId}
		</if>
	</select>
	
	<select id="queryContentSectionList" resultType="com.kjuns.model.ContentSection">
		SELECT id,title,summary,background,isTop, create_by createBy,user_id userId,thumbnail,
		create_date createDate FROM kjuns_section where data_flag = 1 
		order by sort_index desc,create_date desc limit #{pageNo},#{pageSize}
	</select>
	
	<insert id="insertSubscribe" parameterType="com.kjuns.model.ContentSectionSubscribe">
		insert into kjuns_section_subscribe(create_date,create_by,update_by,update_date,data_flag,user_id,section_id,id) 
		values (#{createDate}, #{createBy}, #{updateBy}, #{updateDate}, #{dataFlag}, #{userId},#{sectionId},#{id})
	</insert>
	
	<select id="getRssCount" resultType="int">
		select count(*) from kjuns_section_subscribe where data_flag = 1
		<if test="userId != null and userId != ''">
			and user_id = #{userId}
		</if>
		<if test="sectionId != null and sectionId != ''">
			and section_id = #{sectionId}
		</if>
	</select>
</mapper>